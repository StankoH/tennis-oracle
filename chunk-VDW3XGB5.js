import{a as $}from"./chunk-FNVG6LUR.js";import{a as H,b as j}from"./chunk-O3ILVNDL.js";import{a as B}from"./chunk-ZCX7W3PH.js";import{o as b}from"./chunk-DTJY53OX.js";import{a as R}from"./chunk-DJ4ZLQE5.js";import{a as V}from"./chunk-M6G75PQQ.js";import{Ab as s,Bb as y,Cb as h,Ja as o,Lb as D,Nb as A,Oa as E,Ua as P,Y as F,Za as u,ba as M,eb as p,fc as x,gc as N,ia as _,ib as w,ja as f,kb as n,kc as O,lb as r,mb as g,mc as C,pa as v,qb as T,rb as c,sb as d}from"./chunk-GPF5BPB6.js";function q(l,i){if(l&1){let e=T();n(0,"div",10)(1,"input",11),c("change",function(){let a=_(e).$implicit,m=d();return f(m.toggleTournamentType(a._id))}),r(),n(2,"label",12),s(3),r()()}if(l&2){let e=i.$implicit,t=d();o(),p("id","tournamentType-"+e._id)("checked",t.selectedTournamentTypeIds.includes(e._id)),o(),p("for","tournamentType-"+e._id),o(),h(" ",e.type," ")}}var S=class l{activeTournamentTypeIds=[];filterApplied=new v;resetFilter=new v;closed=new v;tournamentTypes=[{_id:2,type:"ATP"},{_id:4,type:"WTA"}];selectedTournamentTypeIds=[];ngOnInit(){this.selectedTournamentTypeIds=[...this.activeTournamentTypeIds],this.selectedTournamentTypeIds.length===0&&(this.selectedTournamentTypeIds=[2,4])}toggleTournamentType(i){let e=this.selectedTournamentTypeIds.indexOf(i);e>-1?this.selectedTournamentTypeIds.splice(e,1):this.selectedTournamentTypeIds.push(i)}apply(){this.filterApplied.emit([...this.selectedTournamentTypeIds]),this.closed.emit()}reset(){this.selectedTournamentTypeIds=[2,4],this.resetFilter.emit(),this.closed.emit()}close(){this.closed.emit()}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=P({type:l,selectors:[["app-player-filter-modal"]],inputs:{activeTournamentTypeIds:"activeTournamentTypeIds"},outputs:{filterApplied:"filterApplied",resetFilter:"resetFilter",closed:"closed"},decls:18,vars:2,consts:[["appAccessibleClick","",1,"modal-backdrop",3,"accessibleClick"],["appTrapFocus","",1,"modal-content",3,"click","onEscape"],["appAccessibleClick","",1,"close-button",3,"accessibleClick"],[1,"text-center"],[1,"modal-body"],[1,"text-start","mt-3"],["for","tournamentTypeFilter",1,"form-label","fw-bold","mb-1"],["class","form-check d-flex align-items-center gap-2 ms-3",4,"ngFor","ngForOf"],[1,"text-center","mt-3","d-flex","justify-content-center","gap-4"],[1,"link-button",3,"click"],[1,"form-check","d-flex","align-items-center","gap-2","ms-3"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label","mb-0",3,"for"]],template:function(e,t){e&1&&(n(0,"div",0),c("accessibleClick",function(){return t.close()}),n(1,"div",1),c("click",function(m){return m.stopPropagation()}),n(2,"button",2),c("accessibleClick",function(){return t.close()}),s(3,"\xD7"),r(),n(4,"h5",3),s(5,"Filter Players"),r(),g(6,"br"),n(7,"div",4)(8,"div",5)(9,"label",6),s(10,"Filter by Tournament Type:"),r(),n(11,"div",5),u(12,q,4,4,"div",7),r()()(),n(13,"div",8)(14,"button",9),c("click",function(){return t.apply()}),s(15,"Apply"),r(),n(16,"button",9),c("click",function(){return t.reset()}),s(17,"Reset"),r()()()()),e&2&&(o(),p("onEscape",t.close),o(11),p("ngForOf",t.tournamentTypes))},dependencies:[C,x,b,H,j],encapsulation:2})};var I=class l{constructor(i){this.http=i}apiUrl=`${R.apiUrl}/players`;getPaginatedPlayers(i,e,t,a,m=[]){let k={page:i.toString(),pageSize:e.toString(),sortField:t,sortDirection:a};return m.length>0&&m.length<2&&(k.tournamentTypeIds=m.join(",")),this.http.get(`${this.apiUrl}/paginated`,{params:k})}static \u0275fac=function(e){return new(e||l)(M(V))};static \u0275prov=F({token:l,factory:l.\u0275fac,providedIn:"root"})};function J(l,i){l&1&&(n(0,"span",18),s(1,"\u25CF"),r())}function K(l,i){if(l&1&&(n(0,"span"),s(1),r()),l&2){let e=d();o(),y(e.sortDirection==="asc"?"\u2191":"\u2193")}}function Q(l,i){if(l&1&&(n(0,"span"),s(1),r()),l&2){let e=d();o(),y(e.sortDirection==="asc"?"\u2191":"\u2193")}}function X(l,i){if(l&1&&(n(0,"span"),s(1),r()),l&2){let e=d();o(),y(e.sortDirection==="asc"?"\u2191":"\u2193")}}function Y(l,i){if(l&1&&(n(0,"span"),s(1),r()),l&2){let e=d();o(),y(e.sortDirection==="asc"?"\u2191":"\u2193")}}function Z(l,i){if(l&1){let e=T();n(0,"tr")(1,"td"),g(2,"span"),n(3,"span",19),c("click",function(){let a=_(e).$implicit,m=d();return f(m.openPlayerModal(a.playerTPId))}),s(4),r()(),n(5,"td"),s(6),D(7,"date"),r(),n(8,"td"),s(9),r(),n(10,"td"),s(11),r(),n(12,"td"),s(13),r(),n(14,"td"),s(15),r(),n(16,"td"),s(17),r(),n(18,"td"),s(19),r()()}if(l&2){let e=i.$implicit,t=d();o(2),w("fi fi-",e.countryTPId==null||e.countryTPId.countryISO2==null?null:e.countryTPId.countryISO2.toLowerCase(),""),o(2),h(" ",t.decodeHtmlEntities(e.playerName)," "),o(2),h(" ",e.playerBirthDate?A(7,11,e.playerBirthDate,"yyyy-MM-dd"):""," "),o(3),y(e.playerHeight!==void 0&&e.playerHeight>0?e.playerHeight:""),o(2),y(e.playerWeight!==void 0&&e.playerWeight>0?e.playerWeight:""),o(2),h("",e.playerTurnedPro!==void 0&&e.playerTurnedPro>0?e.playerTurnedPro:""," "),o(2),y((e.playsId==null?null:e.playsId.plays)||""),o(2),y(e.trueSkillMean),o(2),y(e.careerTrueSkillMean)}}function ee(l,i){if(l&1){let e=T();n(0,"app-player-modal",20),c("closed",function(){_(e);let a=d();return f(a.closePlayerModal())}),r()}if(l&2){let e=d();p("playerTPId",e.selectedPlayer)}}function te(l,i){if(l&1){let e=T();n(0,"app-player-filter-modal",21),c("closed",function(){_(e);let a=d();return f(a.closeFilterModal())})("filterApplied",function(a){_(e);let m=d();return f(m.onFilterApplied(a))})("resetFilter",function(){_(e);let a=d();return f(a.resetFilter())}),r()}if(l&2){let e=d();p("activeTournamentTypeIds",e.activeTournamentTypeIds)}}var W=class l{constructor(i){this.playerService=i}players=[];currentPage=1;pageSize=100;totalPages=0;selectedPlayer=null;sortField="playerName";sortDirection="asc";isFiltered=!1;showFilterModal=!1;activeTournamentTypeIds=[2,4];ngOnInit(){this.loadPlayers()}loadPlayers(){this.playerService.getPaginatedPlayers(this.currentPage,this.pageSize,this.sortField,this.sortDirection,this.activeTournamentTypeIds).subscribe(i=>{this.players=i.players,this.totalPages=i.pagination.totalPages})}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.loadPlayers(),this.scrollToTop())}previousPage(){this.currentPage>1&&(this.currentPage--,this.loadPlayers(),this.scrollToTop())}openPlayerModal(i){this.selectedPlayer=i,console.log(i)}closePlayerModal(){this.selectedPlayer=null}openFilterModal(){this.showFilterModal=!0}closeFilterModal(){this.showFilterModal=!1}onPageInputChange(i){let e=i.target,t=Number(e.value);!isNaN(t)&&t>=1&&t<=this.totalPages&&(this.currentPage=t,this.loadPlayers(),this.scrollToTop())}scrollToTop(){let i=document.querySelector(".player-table-wrapper");i&&(i.scrollTop=0)}decodeHtmlEntities(i){let e=document.createElement("textarea");return e.innerHTML=i,e.value}sortPlayers(){this.players.sort((i,e)=>{let t="",a="";switch(this.sortField){case"playerName":t=i.playerName?.toLowerCase()||"",a=e.playerName?.toLowerCase()||"";break;case"playerBirthDate":t=i.playerBirthDate?new Date(i.playerBirthDate).getTime():0,a=e.playerBirthDate?new Date(e.playerBirthDate).getTime():0;break;case"trueSkillMean":t=i.trueSkillMean??0,a=e.trueSkillMean??0;break;case"careerTrueSkillMean":t=i.careerTrueSkillMean??0,a=e.careerTrueSkillMean??0;break}let m=t<a?-1:t>a?1:0;return this.sortDirection==="asc"?m:-m})}toggleSort(i){this.sortField===i?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=i,this.sortDirection="asc"),this.loadPlayers()}onFilterApplied(i){this.activeTournamentTypeIds=i,this.isFiltered=i.length!==2,this.currentPage=1,this.loadPlayers(),this.closeFilterModal()}resetFilter(){this.activeTournamentTypeIds=[2,4],this.isFiltered=!1,this.currentPage=1,this.loadPlayers(),this.closeFilterModal()}static \u0275fac=function(e){return new(e||l)(E(I))};static \u0275cmp=P({type:l,selectors:[["app-players"]],decls:43,vars:13,consts:[[1,"players-page-wrapper"],[1,"date-nav-sticky","d-flex","align-items-center","justify-content-between","mt-3","px-2"],[1,"pagination-center-wrapper","mx-auto","d-flex","align-items-center","gap-3"],[1,"link-button",3,"click","disabled"],["src","assets/icons/left.svg","alt","Previous",1,"arrow-icon"],["type","number","min","1",1,"custom-page-input","no-spin",3,"change","value","max"],["src","assets/icons/right.svg","alt","Next",1,"arrow-icon"],[1,"filter-button-wrapper"],[1,"link-button","d-flex","align-items-center","gap-2",3,"click"],["src","assets/icons/filter.svg","alt","Filter",1,"arrow-icon"],["class","badge bg-success ms-1",4,"ngIf"],[1,"player-table-wrapper"],[1,"player-table"],[3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"playerTPId","closed",4,"ngIf"],[3,"activeTournamentTypeIds","closed","filterApplied","resetFilter",4,"ngIf"],[1,"badge","bg-success","ms-1"],[1,"clickable-text",3,"click"],[3,"closed","playerTPId"],[3,"closed","filterApplied","resetFilter","activeTournamentTypeIds"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),c("click",function(){return t.previousPage()}),g(4,"img",4),r(),n(5,"input",5),c("change",function(m){return t.onPageInputChange(m)}),r(),n(6,"span"),s(7),r(),n(8,"button",3),c("click",function(){return t.nextPage()}),g(9,"img",6),r()(),n(10,"div",7)(11,"button",8),c("click",function(){return t.openFilterModal()}),g(12,"img",9),s(13," Filter "),u(14,J,2,0,"span",10),r()()(),n(15,"div",11)(16,"table",12)(17,"thead")(18,"tr")(19,"th",13),c("click",function(){return t.toggleSort("playerName")}),s(20," Name "),u(21,K,2,1,"span",14),r(),n(22,"th",13),c("click",function(){return t.toggleSort("playerBirthDate")}),s(23," Birth Date "),u(24,Q,2,1,"span",14),r(),n(25,"th"),s(26,"Height (cm)"),r(),n(27,"th"),s(28,"Weight (kg)"),r(),n(29,"th"),s(30,"Turned Pro"),r(),n(31,"th"),s(32,"Plays"),r(),n(33,"th",13),c("click",function(){return t.toggleSort("trueSkillMean")}),s(34," TS Mean "),u(35,X,2,1,"span",14),r(),n(36,"th",13),c("click",function(){return t.toggleSort("careerTrueSkillMean")}),s(37," TS Mean Career "),u(38,Y,2,1,"span",14),r()()(),n(39,"tbody"),u(40,Z,20,14,"tr",15),r()()(),u(41,ee,1,1,"app-player-modal",16)(42,te,1,1,"app-player-filter-modal",17),r()),e&2&&(o(3),p("disabled",t.currentPage===1),o(2),p("value",t.currentPage)("max",t.totalPages),o(2),h("of ",t.totalPages,""),o(),p("disabled",t.currentPage===t.totalPages),o(6),p("ngIf",t.isFiltered),o(7),p("ngIf",t.sortField==="playerName"),o(3),p("ngIf",t.sortField==="playerBirthDate"),o(11),p("ngIf",t.sortField==="trueSkillMean"),o(3),p("ngIf",t.sortField==="careerTrueSkillMean"),o(2),p("ngForOf",t.players),o(),p("ngIf",t.selectedPlayer),o(),p("ngIf",t.showFilterModal))},dependencies:[C,x,N,O,b,B,$,S],encapsulation:2})};export{W as PlayersComponent};
